@using System.Web.UI.WebControls;
@{
    ViewBag.Title = "View1";
    int expandRowindex = ViewData["CustomerID"] != null ?(int)ViewData["CustomerID"]:0;

}


@Html.DevExpress().GridView(
    settings =>
    {
        settings.Name = "grid";
        settings.CallbackRouteValues = new { Controller = "Home", Action = "MasterDetailMasterPartial"};
        settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);


        settings.KeyFieldName = "EmployeeID";
        settings.Columns.Add("LastName");
        settings.Columns.Add("FirstName");
        settings.Columns.Add("Title");
        settings.Columns.Add("Country");

        settings.SettingsDetail.AllowOnlyOneMasterRowExpanded = false;
        settings.SettingsDetail.ShowDetailRow = true;

        settings.SetDetailRowTemplateContent(c =>
        {
            //ViewContext.Writer.Write(
            //    "Contact Phone: <b>" +
            //        DataBinder.Eval(c.DataItem, "HomePhone") + "</b>, Fax: <b>" +
            //            DataBinder.Eval(c.DataItem, "PostalCode") + "</b>" +
            //    "<br />" +
            //    "<br />"
            //);
            Html.RenderAction("MasterDetailDetailPartial", new { EmployeeID = DataBinder.Eval(c.DataItem, "EmployeeID") });
        });
    
        settings.PreRender = (sender, e) =>
        {
            ((MVCxGridView)sender).DetailRows.ExpandRow(0);
        };

        //settings. = (sender, e) =>
        //{
        //    ((MVCxGridView)sender).DetailRows.ExpandRow(e.VisibleIndex);
        //};
       
        //settings.DetailRowExpandedChanged = (sender, e) =>
        //{
        //    index = e.VisibleIndex;
        //    ((MVCxGridView)sender).DetailRows.ExpandRow(e.VisibleIndex);
        //    ((MVCxGridView)sender).DetailRows.ExpandRowByKey(e.Expanded);
            
        //};

    }).Bind(Model).GetHtml()

@*@section Scripts{
    
<script src="~/Scripts/jquery-1.7.1.min.js"></script>
    }*@