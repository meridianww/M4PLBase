
INSERT INTO [dbo].[JOBDL000Master]
           ([JobMITJobID]
           ,[ProgramID]
           ,[JobSiteCode]
           ,[JobConsigneeCode]
           ,[JobCustomerSalesOrder]
           ,[JobBOL]
           ,[JobBOLMaster]
           ,[JobBOLChild]
           ,[JobCustomerPurchaseOrder]
           ,[JobCarrierContract]
           ,[JobManifestNo]
           ,[JobGatewayStatus]
           ,[StatusId]
           ,[JobStatusedDate]
           ,[JobCompleted]
           ,[JobType]
           ,[ShipmentType]
           ,[JobDeliveryAnalystContactID]
           ,[JobDeliveryResponsibleContactID]
           ,[PlantIDCode]
           ,[JobRouteId]
           ,[JobDriverId]
           ,[JobStop]
           ,[CarrierID]
           ,[JobSignText]
           ,[JobSignLatitude]
           ,[JobSignLongitude]
           ,[WindowDelStartTime]
           ,[WindowDelEndTime]
           ,[WindowPckStartTime]
           ,[WindowPckEndTime]
           ,[JobDeliverySitePOC]
           ,[JobDeliverySitePOCPhone]
           ,[JobDeliverySitePOCEmail]
           ,[JobDeliverySiteName]
           ,[JobDeliveryStreetAddress]
           ,[JobDeliveryStreetAddress2]
           ,[JobDeliveryCity]
           ,[JobDeliveryState]
           ,[JobDeliveryPostalCode]
           ,[JobDeliveryCountry]
           ,[JobDeliveryTimeZone]
           ,[JobDeliveryDateTimePlanned]
           ,[JobDeliveryDateTimeActual]
           ,[JobDeliveryDateTimeBaseline]
           ,[JobDeliveryComment]
           ,[JobDeliveryRecipientPhone]
           ,[JobDeliveryRecipientEmail]
           ,[JobLatitude]
           ,[JobLongitude]
           ,[JobOriginResponsibleContactID]
           ,[JobOriginSiteCode]
           ,[JobOriginSitePOC]
           ,[JobOriginSitePOCPhone]
           ,[JobOriginSitePOCEmail]
           ,[JobOriginSiteName]
           ,[JobOriginStreetAddress]
           ,[JobOriginStreetAddress2]
           ,[JobOriginCity]
           ,[JobOriginState]
           ,[JobOriginPostalCode]
           ,[JobOriginCountry]
           ,[JobOriginTimeZone]
           ,[JobOriginDateTimePlanned]
           ,[JobOriginDateTimeActual]
           ,[JobOriginDateTimeBaseline]
           ,[JobProcessingFlags]
           ,[JobDeliverySitePOC2]
           ,[JobDeliverySitePOCPhone2]
           ,[JobDeliverySitePOCEmail2]
           ,[JobOriginSitePOC2]
           ,[JobOriginSitePOCPhone2]
           ,[JobOriginSitePOCEmail2]
           ,[JobSellerCode]
           ,[JobSellerSitePOC]
           ,[JobSellerSitePOCPhone]
           ,[JobSellerSitePOCEmail]
           ,[JobSellerSitePOC2]
           ,[JobSellerSitePOCPhone2]
           ,[JobSellerSitePOCEmail2]
           ,[JobSellerSiteName]
           ,[JobSellerStreetAddress]
           ,[JobSellerStreetAddress2]
           ,[JobSellerCity]
           ,[JobSellerState]
           ,[JobSellerPostalCode]
           ,[JobSellerCountry]
           ,[JobUser01]
           ,[JobUser02]
           ,[JobUser03]
           ,[JobUser04]
           ,[JobUser05]
           ,[JobStatusFlags]
           ,[JobScannerFlags]
           ,[ProFlags01]
           ,[ProFlags02]
           ,[ProFlags03]
           ,[ProFlags04]
           ,[ProFlags05]
           ,[ProFlags06]
           ,[ProFlags07]
           ,[ProFlags08]
           ,[ProFlags09]
           ,[ProFlags10]
           ,[ProFlags11]
           ,[ProFlags12]
           ,[ProFlags13]
           ,[ProFlags14]
           ,[ProFlags15]
           ,[ProFlags16]
           ,[ProFlags17]
           ,[ProFlags18]
           ,[ProFlags19]
           ,[ProFlags20]
           ,[EnteredBy]
           ,[DateEntered]
           ,[ChangedBy]
           ,[DateChanged])
     
    SELECT [JobMITJobID]
           ,(SELECT TOP 1 ID FROM [dbo].[PRGRM000Master] WHERE PrgProgramCode = PM.PrgProgramCode AND StatusId = 1) --PR.ID --[ProgramID]
           ,TS.[JobSiteCode]
           ,TS.[JobConsigneeCode]
           ,TS.[JobCustomerSalesOrder]
           ,TS.[JobBOL]
           ,TS.[JobBOLMaster]
           ,TS.[JobBOLChild]
           ,TS.[JobCustomerPurchaseOrder]
           ,TS.[JobCarrierContract]
           ,TS.[JobManifestNo]
           ,TS.[JobGatewayStatus]
           ,TS.[StatusId]
           ,TS.[JobStatusedDate]
           ,TS.[JobCompleted]
           ,TS.[JobType]
           ,TS.[ShipmentType]
           ,(select TOP 1 f.id from [dbo].[CONTC000Master] f where f.ConEmailAddress = ISNULL((select TOP 1 m.ConEmailAddress from [M4PL_3030_Test].[dbo].[CONTC000Master] m where m.Id = TS.JobDeliveryAnalystContactID), -1))--ja.Id--[JobDeliveryAnalystContactID]
           ,(select TOP 1 f.id from [dbo].[CONTC000Master] f where f.ConEmailAddress = ISNULL((select TOP 1 m.ConEmailAddress from [M4PL_3030_Test].[dbo].[CONTC000Master] m where m.Id = TS.JobDeliveryResponsibleContactID), -1))--jr.Id--[JobDeliveryResponsibleContactID]
           ,TS.[PlantIDCode]
           ,TS.[JobRouteId]
           ,(select TOP 1 f.id from [dbo].[CONTC000Master] f where f.ConEmailAddress = ISNULL((select TOP 1 m.ConEmailAddress from [M4PL_3030_Test].[dbo].[CONTC000Master] m where m.Id = TS.JobDriverId), -1))--jd.Id--[JobDriverId]
           ,TS.[JobStop]
           ,TS.[CarrierID]
           ,TS.[JobSignText]
           ,TS.[JobSignLatitude]
           ,TS.[JobSignLongitude]
           ,TS.[WindowDelStartTime]
           ,TS.[WindowDelEndTime]
           ,TS.[WindowPckStartTime]
           ,TS.[WindowPckEndTime]
           ,TS.[JobDeliverySitePOC]
           ,TS.[JobDeliverySitePOCPhone]
           ,TS.[JobDeliverySitePOCEmail]
           ,TS.[JobDeliverySiteName]
           ,TS.[JobDeliveryStreetAddress]
           ,TS.[JobDeliveryStreetAddress2]
           ,TS.[JobDeliveryCity]
           ,TS.[JobDeliveryState]
           ,TS.[JobDeliveryPostalCode]
           ,TS.[JobDeliveryCountry]
           ,TS.[JobDeliveryTimeZone]
           ,TS.[JobDeliveryDateTimePlanned]
           ,TS.[JobDeliveryDateTimeActual]
           ,TS.[JobDeliveryDateTimeBaseline]
           ,TS.[JobDeliveryComment]
           ,TS.[JobDeliveryRecipientPhone]
           ,TS.[JobDeliveryRecipientEmail]
           ,TS.[JobLatitude]
           ,TS.[JobLongitude]
           ,TS.[JobOriginResponsibleContactID]
           ,TS.[JobOriginSiteCode]
           ,TS.[JobOriginSitePOC]
           ,TS.[JobOriginSitePOCPhone]
           ,TS.[JobOriginSitePOCEmail]
           ,TS.[JobOriginSiteName]
           ,TS.[JobOriginStreetAddress]
           ,TS.[JobOriginStreetAddress2]
           ,TS.[JobOriginCity]
           ,TS.[JobOriginState]
           ,TS.[JobOriginPostalCode]
           ,TS.[JobOriginCountry]
           ,TS.[JobOriginTimeZone]
           ,TS.[JobOriginDateTimePlanned]
           ,TS.[JobOriginDateTimeActual]
           ,TS.[JobOriginDateTimeBaseline]
           ,TS.[JobProcessingFlags]
           ,TS.[JobDeliverySitePOC2]
           ,TS.[JobDeliverySitePOCPhone2]
           ,TS.[JobDeliverySitePOCEmail2]
           ,TS.[JobOriginSitePOC2]
           ,TS.[JobOriginSitePOCPhone2]
           ,TS.[JobOriginSitePOCEmail2]
           ,TS.[JobSellerCode]
           ,TS.[JobSellerSitePOC]
           ,TS.[JobSellerSitePOCPhone]
           ,TS.[JobSellerSitePOCEmail]
           ,TS.[JobSellerSitePOC2]
           ,TS.[JobSellerSitePOCPhone2]
           ,TS.[JobSellerSitePOCEmail2]
           ,TS.[JobSellerSiteName]
           ,TS.[JobSellerStreetAddress]
           ,TS.[JobSellerStreetAddress2]
           ,TS.[JobSellerCity]
           ,TS.[JobSellerState]
           ,TS.[JobSellerPostalCode]
           ,TS.[JobSellerCountry]
           ,TS.[JobUser01]
           ,TS.[JobUser02]
           ,TS.[JobUser03]
           ,TS.[JobUser04]
           ,TS.[JobUser05]
           ,TS.[JobStatusFlags]
           ,TS.[JobScannerFlags]
           ,TS.[ProFlags01]
           ,TS.[ProFlags02]
           ,TS.[ProFlags03]
           ,TS.[ProFlags04]
           ,TS.[ProFlags05]
           ,TS.[ProFlags06]
           ,TS.[ProFlags07]
           ,TS.[ProFlags08]
           ,TS.[ProFlags09]
           ,TS.[ProFlags10]
           ,TS.[ProFlags11]
           ,TS.[ProFlags12]
           ,TS.[ProFlags13]
           ,TS.[ProFlags14]
           ,TS.[ProFlags15]
           ,TS.[ProFlags16]
           ,TS.[ProFlags17]
           ,TS.[ProFlags18]
           ,TS.[ProFlags19]
           ,TS.[ProFlags20]
           ,TS.[EnteredBy]
           ,TS.[DateEntered]
           ,TS.[ChangedBy]
           ,TS.[DateChanged] FROM [M4PL_3030_Test].[dbo].[JOBDL000Master] TS
			INNER JOIN [M4PL_3030_Test].[dbo].[PRGRM000Master] PM on PM.Id = TS.ProgramID
		   WHERE PM.PrgOrgID = 1
GO