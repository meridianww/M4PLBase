@using M4PL.Web.Providers;
@using Newtonsoft.Json;
@model M4PL.Entities.Support.MvcRoute
@{
    List<long> jobIds = new List<long>();
    Model.JobIds.ForEach(t => { if (!string.IsNullOrEmpty(t)) jobIds.Add(Convert.ToInt64(t)); });
    long parentRecordId = ViewBag.ParentRecordId;
}

@if (jobIds != null && jobIds.Count() > 0 && ViewData["Actions"] != null)
{
    Html.DevExpress().ComboBox(settings =>
    {
        settings.Name = "MultiActionComboBox";
        settings.Width = 180;
        settings.SelectedIndex = 0;
        settings.CallbackRouteValues = new { Controller = "JobGateway", Action = "AddMultiAction", Area = "Job" };
        settings.Properties.CallbackPageSize = 15;
        settings.Properties.ClearButton.DisplayMode = ClearButtonDisplayMode.OnHover;
        settings.Properties.ClientSideEvents.SelectedIndexChanged = "M4PLCommon.JobMultiSelect.ActionDropDownChange";
    }).BindList((List<string>)ViewData["Actions"]).GetHtml();

    Html.RenderAction("MultiActionComboBoxPartial");

    Html.DevExpress().Button(
                    settings =>
                    {
                        settings.Name = "BtnSubmitActionGateway";
                        settings.Text = "ADD ACTION";
                        settings.Width = 120;
                        settings.ClientVisible = false;
                        settings.GroupName = "FakeGroup";
                        settings.ClientSideEvents.CheckedChanged = string.Format("function(s, e, strRoute){{ M4PLCommon.JobMultiSelect.BtnSubmitActionGateway(s, e, '{0}'); }}", JsonConvert.SerializeObject(Model));
                    }
                )
                .Render();
}
else
{
    <strong class="danger">@ViewBag.Message</strong>
}